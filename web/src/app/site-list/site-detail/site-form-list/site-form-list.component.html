<div class="d-flex flex-wrap gap-2 mb-2">
  <span 
    [title]="!canCreateSitePermit() ? '所有角色都可以新增工地許可單' : ''"
    class="d-inline-block"
  >
    <button 
      class="btn btn-primary text-nowrap" 
      (click)="createSitePermit()"
      [disabled]="!canCreateSitePermit()"
    >新增工地許可單</button>
  </span>
  <span
    [title]="!canCreateToolboxMeeting() ? '只有專案經理、專案工程師、工地經理、環安主管、環安工程師可以新增工具箱會議' : ''"
    class="d-inline-block"
  >
    <button
      class="btn btn-primary text-nowrap"
      (click)="createToolboxMeeting()"
      [disabled]="!canCreateToolboxMeeting()"
    >新增工具箱會議</button>
  </span>
  <span 
    [title]="!canCreateEnvironmentCheckList() ? '只有專案經理、專案工程師、工地經理、環安主管、環安工程師可以新增環安衛自主檢點表' : ''"
    class="d-inline-block"
  >
    <button 
      class="btn btn-primary text-nowrap" 
      (click)="createEnvironmentCheckList()"
      [disabled]="!canCreateEnvironmentCheckList()"
    >新增環安衛自主檢點表</button>
  </span>
  <span 
    [title]="!canCreateSpecialWorkChecklist() ? '只有專案經理、專案工程師、工地經理、環安主管、環安工程師可以新增特殊作業自主檢點表' : ''"
    class="d-inline-block"
  >
    <button 
      class="btn btn-primary text-nowrap" 
      (click)="createSpecialWorkChecklist()"
      [disabled]="!canCreateSpecialWorkChecklist()"
    >新增特殊作業自主檢點表</button>
  </span>
  <span 
    [title]="!canCreateSafetyIssueRecord() ? '只有專案經理、專案工程師、工地經理、環安主管、環安工程師可以新增缺失記錄單' : ''"
    class="d-inline-block"
  >
    <button 
      class="btn btn-primary text-nowrap" 
      (click)="createSafetyIssueRecord()"
      [disabled]="!canCreateSafetyIssueRecord()"
    >新增缺失記錄單</button>
  </span>
  <span 
    [title]="!canCreateSafetyPatrolChecklist() ? '只有環安主管、環安工程師可以新增工安巡迴檢查表' : ''"
    class="d-inline-block"
  >
    <button 
      class="btn btn-primary text-nowrap" 
      (click)="createSafetyPatrolChecklist()"
      [disabled]="!canCreateSafetyPatrolChecklist()"
    >新增工安巡迴檢查表</button>
  </span>
  <!-- <span 
    [title]="!canCreateTraining() ? '所有角色都可以新增教育訓練' : ''"
    class="d-inline-block"
  >
    <button 
      class="btn btn-primary text-nowrap" 
      (click)="createTraining()"
      [disabled]="!canCreateTraining()"
    >新增教育訓練</button>
  </span> -->
  
  <!-- 權限說明燈泡按鈕 -->
  <div class="ms-auto">
    <button 
      class="btn btn-outline-info btn-sm" 
      (click)="showPermissionInfo()"
      title="查看權限說明"
    >
      <i class="fas fa-lightbulb"></i>
    </button>
  </div>
</div>
<div class="calendar-container">
  <full-calendar
    [options]="calendarOptions"
    #calendar>
  </full-calendar>
</div>

<!-- 權限說明 Modal -->
<div
  class="modal fade"
  id="permissionInfoModal"
  tabindex="-1"
  aria-labelledby="permissionInfoModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="permissionInfoModalLabel">
          <i class="fas fa-shield-alt me-2"></i>表單新增權限說明
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="關閉"
        ></button>
      </div>
      <div class="modal-body">
        <div class="table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="table-dark">
              <tr class="text-nowrap">
                <th scope="col" class="text-center align-middle">表單類型</th>
                <th scope="col" class="text-center">專案<br>經理</th>
                <th scope="col" class="text-center">專案<br>秘書</th>
                <th scope="col" class="text-center">專案<br>工程師</th>
                <th scope="col" class="text-center">工地<br>經理</th>
                <th scope="col" class="text-center">環安<br>主管</th>
                <th scope="col" class="text-center">環安<br>工程師</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="fw-bold">工地許可單</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
              </tr>
              <tr class="table-light">
                <td class="fw-bold">工具箱會議</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-muted">－</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
              </tr>
              <tr>
                <td class="fw-bold">環安衛自主檢點表</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-muted">－</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
              </tr>
              <tr class="table-light">
                <td class="fw-bold">特殊作業自主檢點表</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-muted">－</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
              </tr>
              <tr>
                <td class="fw-bold">缺失記錄單</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-muted">－</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
              </tr>
              <tr class="table-light">
                <td class="fw-bold">工安巡迴檢查表</td>
                <td class="text-center text-muted">－</td>
                <td class="text-center text-muted">－</td>
                <td class="text-center text-muted">－</td>
                <td class="text-center text-muted">－</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
              </tr>
              <tr>
                <td class="fw-bold">教育訓練</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
                <td class="text-center text-success fs-5">✓</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="alert alert-info">
          <i class="fas fa-info-circle me-2"></i>
          <strong>圖例：</strong>
          <span class="text-success fs-6 me-3">✓ 有權限</span>
          <span class="text-muted fs-6">－ 無權限</span>
        </div>
        <div class="alert alert-warning">
          <i class="fas fa-triangle-exclamation me-2"></i>
          <strong>說明：</strong>如果您看不到某個按鈕或按鈕呈現灰色狀態，表示您的角色沒有權限新增該類型的表單。
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
        >
          關閉
        </button>
      </div>
    </div>
  </div>
</div>
