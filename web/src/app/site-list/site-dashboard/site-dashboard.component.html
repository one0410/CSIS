<div class="dashboard-container">
  <!-- 頂部統計卡片區 -->
  <div class="dashboard-header">
    <!-- 日期卡片 -->
    <div class="info-card">
      <h3 class="card-title">今日日期</h3>
      <div class="card-content">
        <div class="large-value">{{ todayDate }}</div>
      </div>
    </div>

    <!-- 工程進度卡片 -->
    <div class="info-card">
      <h3 class="card-title">工程進度</h3>
      <div class="card-content">
        <div class="progress-banner">
          <div class="progress-icon">
            <i class="bi bi-bar-chart-fill"></i>
          </div>
          <div class="progress-details">
            <div class="progress-value">{{ currentProjectProgress }}%</div>
            <div class="progress-bar">
              <div
                class="progress-fill"
                [style.width]="currentProjectProgress + '%'"
              ></div>
            </div>
          </div>
        </div>

        <!-- 工程日數資訊 -->
        <div class="timeline-info">
          <div class="stat-card">
            <div class="stat-value">{{ allProjectDays }}</div>
            <div class="stat-label">總工程日數</div>
          </div>
          <div class="timeline-separator">
            <div class="timeline-line"></div>
          </div>
          <div class="stat-card">
            <div class="stat-value">{{ todayProjectDays }}</div>
            <div class="stat-label">已過日數</div>
            <div class="stat-subtitle">
              {{ ((todayProjectDays / allProjectDays) * 100).toFixed(1) }}%
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 天氣資訊卡 -->
    <div
      class="info-card"
      (click)="navigateTo('weather')"
      [class.clickable]="true"
      title="點擊後查看今日天氣詳細資訊"
    >
      <h3 class="card-title">
        今日天氣({{ site?.county }})
        <span class="info-icon-right"
          ><i
            class="bi bi-info-circle"
            title="顯示目前工地所在區域的天氣資訊"
          ></i
        ></span>
      </h3>
      <div class="card-content weather-content">
        <div class="weather-icon">
          <i class="bi bi-cloud-sun"></i>
        </div>
        <div class="weather-value">{{ todayWeather }}</div>
      </div>
    </div>
  </div>

  <!-- 其他統計資訊 -->
  <div class="stats-grid">
    <div
      class="info-card"
      (click)="navigateTo('permit')"
      [class.clickable]="true"
      title="點擊後查看許可單統計詳細資訊"
    >
      <h3 class="card-title">
        許可單統計
        <span class="info-icon-right"
          ><i class="bi bi-info-circle" title="顯示今日許可單數量統計"></i
        ></span>
      </h3>
      <div class="card-content stat-content">
        <div class="stat-tile-icon">
          <i class="bi bi-file-earmark-check-fill"></i>
        </div>
        <div class="large-value">{{ todayPermitCount }}</div>
        <div class="stat-subtitle">今日許可單數</div>
      </div>
    </div>

    <div class="info-card">
      <h3 class="card-title">人員統計</h3>
      <div class="card-content stat-content">
        <div class="stat-tile-icon">
          <i class="bi bi-people-fill"></i>
        </div>
        <div class="large-value">{{ todayWorkerCount }}</div>
        <div class="stat-subtitle">今日工地人數</div>
      </div>
    </div>

    <div
      class="info-card"
      (click)="navigateTo('flaw')"
      [class.clickable]="true"
      title="點擊後查看缺失統計詳細資訊"
    >
      <h3 class="card-title">
        缺失統計
        <span class="info-icon-right"
          ><i class="bi bi-info-circle" title="顯示今日缺失單數量統計"></i
        ></span>
      </h3>
      <div class="card-content stat-content">
        <div class="stat-tile-icon">
          <i class="bi bi-exclamation-triangle-fill"></i>
        </div>
        <div class="large-value">{{ todayFlawCount }}</div>
        <div class="stat-subtitle">今日缺失單數</div>
      </div>
    </div>
  </div>

  <!-- 圖表區域 -->
  <div class="charts-container">
    <div class="info-card">
      <h3 class="card-title">工程進度趨勢</h3>
      <div class="card-content">
        <app-progress-trend-chart [siteId]="siteId"></app-progress-trend-chart>
      </div>
    </div>

    <div class="info-card">
      <h3 class="card-title">缺失趨勢</h3>
      <div class="card-content chart-wrapper">
        <canvas #chartFlaw id="chartFlaw"></canvas>
      </div>
    </div>
  </div>
</div>
